# Books Service – Keycloak арқылы авторизация

Бұл жобада пайдаланушы алдымен Keycloak арқылы тіркеледі, жүйеге кіреді (login)  
және алған token арқылы кітаптар сервисіне сұраныс жібереді.

Барлық процесс төменде рет-ретімен түсіндірілген.

---

1. Пайдаланушыны тіркеу (Register)

Алдымен жаңа пайдаланушыны тіркеу керек.

POST сұраныс:
http://localhost:8083/auth/register

JSON форматы:
{
"username": "Alibi",
"email": "alibi@gmail.com",
"password": "Alibi"
}

Бұл сұраныс Keycloak-та жаңа қолданушыны тіркейді.

---

2. Жүйеге кіру (Login)

Тіркелгеннен кейін логин жасаймыз.

POST сұраныс:
http://localhost:8083/auth/login

JSON форматы:
{
"username": "Alibi",
"password": "Alibi"
}

Егер логин мен пароль дұрыс болса, жауап ретінде access token аламыз.
Осы token кейінгі барлық қорғалған сұраныстар үшін қолданылады.

---

3. Кітап қосу (POST /books)

Login жасағаннан кейін алынған token-мен кітаптар сервисіне сұраныс жібереміз.

POST сұраныс:
http://localhost:8084/books

Header:
Authorization: Bearer TOKEN

JSON форматы:
{
"title": "Abai zholy",
"author": "M. Auezov",
"year": 1942
}

Бұл сұраныс кітапты дерекқорға (database) сақтайды.

---

4. Кітапты алу (GET /books/{id})

Кітапты ID арқылы аламыз.

GET сұраныс:
http://localhost:8084/books/1

Жұмыс істеу логикасы:
Алғашқы GET сұраныста мәлімет DB-дан алынады  
және сол мәлімет кэшке сақталады.

Келесі дәл осы кітапқа жасалған GET сұраныстарда  
мәлімет тікелей кэштен алынады, сондықтан жүйе жылдамырақ жұмыс істейді.

---

Қорытынды:
- Авторизация және аутентификация Keycloak арқылы жасалады
- Login кезінде token аламыз
- Token арқылы кітаптар сервисіне қол жеткіземіз
- GET сұраныс алдымен database, кейін кэш арқылы жұмыс істейді
